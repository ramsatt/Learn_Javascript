
      


<h1>Web Geolocation API</h1>

<hr>
<!--start-->
<h2>Locate the User's Position</h2>
<p>The HTML Geolocation API is used to get the geographical position of a user.</p>
<p id="demo">Since this can compromise privacy, the position is not available unless the user approves it.</p>

<p><button class="w3-btn w3-blue" onclick="getLocation()"></button></p>
<div id="mapholder"></div>


<div class="w3-panel ws-note">
<h2>Note</h2>
<p>Geolocation is most accurate for devices with GPS, like smartphones.</p>
</div>
<!--stop-->
<hr>
<!--start-->
<h2>Browser Support</h2>
<p>The Geolocation API is supported in all browsers:</p>
<div class="table-responsive-wrapper"><table class="browserref notranslate">
  <tbody><tr>
    <th class="bsChrome" title="Chrome"></th>
    <th class="bsEdge" title="Internet Explorer / Edge"></th>
    <th class="bsFirefox" title="Firefox"></th>
    <th class="bsSafari" title="Safari"></th>
    <th class="bsOpera" title="Opera"></th>                
  </tr>
  <tr>
    <td>Yes</td>
    <td>Yes</td>
    <td>Yes</td>
    <td>Yes</td>
    <td>Yes</td>
  </tr>
</tbody></table></div>
<hr>
<div class="w3-panel ws-note">
<h2>Note</h2>
<p>The Geolocation API will only work on secure contexts such 
as HTTPS.</p>
<p>If your site is hosted on a non-secure origin (such as HTTP) the 
requests to get the users location will no longer function.</p>
</div>
<!--stop-->
<hr>
<!--start-->
<h2>Using the Geolocation API</h2>
<p>The <code class="w3-codespan">getCurrentPosition()</code> method is used to return the user's position.</p>
<p>The example below returns the latitude and longitude of the user's position:</p>
<div class="w3-example">
<h3>Example</h3>
<pre class="w3-code"><code class="language-html">&lt;script&gt;
const x = document.getElementById("demo");
function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);
  } else {
    x.innerHTML = "Geolocation is not supported by this browser.";
  }
}
function showPosition(position) {
  x.innerHTML = "Latitude: " + position.coords.latitude +
  "&lt;br&gt;Longitude: " + position.coords.longitude;
}
&lt;/script&gt;</code></pre>

</div>
<p>Example explained:</p>
<ul>
  <li>Check if Geolocation is supported</li>
  <li>If supported, run the getCurrentPosition() method. If not, display a message to the user</li>
  <li>If the getCurrentPosition() method is successful, it returns a coordinates object to the function specified in the parameter (showPosition)</li>
  <li>The showPosition() function outputs the Latitude and Longitude</li>
</ul>
<p>The example above is a very basic Geolocation script, with no error handling.</p>
<hr>
<!--stop-->

<hr>
<!--start-->
<h2>Handling Errors and Rejections</h2>
<p>The second parameter of the <code class="w3-codespan">getCurrentPosition()</code> method is used to handle 
errors. It specifies a function to run if it fails to get the user's location:</p>
<div class="w3-example">
<h3>Example</h3>
<pre class="w3-code"><code class="language-javascript">function showError(error) {
  switch(error.code) {
    case error.PERMISSION_DENIED:
      x.innerHTML = "User denied the request for Geolocation."
      break;
    case error.POSITION_UNAVAILABLE:
      x.innerHTML = "Location information is unavailable."
      break;
    case error.TIMEOUT:
      x.innerHTML = "The request to get user location timed out."
      break;
    case error.UNKNOWN_ERROR:
      x.innerHTML = "An unknown error occurred."
      break;
  }
}</code></pre>

</div>
<!--stop-->
<hr>
<!--start-->
<h2>Displaying the Result in a Map</h2>
<p>To display the result in a map, you need access to a map service, like Google 
Maps.</p>
<p>In the example below, the returned latitude and longitude is used to show the location in a Google 
Map (using a static image):</p>
<div class="w3-example">
<h3>Example</h3>
<pre class="w3-code"><code class="language-javascript">function showPosition(position) {
  let latlon = position.coords.latitude + "," + position.coords.longitude;
  let img_url = "https://maps.googleapis.com/maps/api/staticmap?center=
  "+latlon+"&amp;zoom=14&amp;size=400x300&amp;sensor=false&amp;key=YOUR_KEY";
  document.getElementById("mapholder").innerHTML = "&lt;img src='"+img_url+"'&gt;";
}</code></pre>
<!--<a class="w3-btn w3-margin-bottom" href="tryit.asp?filename=tryhtml5_geolocation_map" target="_blank"> &raquo;</a>-->
</div>
<!--<p><a href="tryit.asp?filename=tryhtml5_geolocation_map_script" target="_blank">Google Map Script</a><br>
How to show an interactive Google Map with a marker, zoom and drag options.</p>-->
<!--stop-->
<hr>
<!--start-->
<h2>Location-specific Information</h2>
<p>This page has demonstrated how to show a user's position on a map.</p>
<p>Geolocation is also very useful for location-specific information, like:</p>
<ul>
  <li>Up-to-date local information</li>
  <li>Showing Points-of-interest near the user</li>
  <li>Turn-by-turn navigation (GPS)</li>
</ul>
<!--stop-->
<hr>
<!--start-->
<h2>The getCurrentPosition() Method - Return Data</h2>
<p>The <code class="w3-codespan">getCurrentPosition()</code> method returns an object on success. The latitude, 
longitude and accuracy properties are always returned. The other properties are returned 
if available:</p>

<div class="table-responsive-wrapper"><table class="ws-table-all notranslate">
<tbody><tr>
<th style="width:150px">Property</th>
<th>Returns</th>
</tr>
  <tr>
<td>coords.latitude</td>
<td>The latitude as a decimal number (always returned)</td>
  </tr>
  <tr>
<td>coords.longitude</td>
<td>The longitude as a decimal number (always returned)</td>
  </tr>
  <tr>
<td>coords.accuracy</td>
<td>The accuracy of position (always returned)</td>
  </tr>
  <tr>
<td>coords.altitude</td>
<td>The altitude in meters above the mean sea level (returned if available)</td>
  </tr>
  <tr>
<td>coords.altitudeAccuracy</td>
<td>The altitude accuracy of position (returned if available)</td>
  </tr>
  <tr>
<td>coords.heading</td>
<td>The heading as degrees clockwise from North (returned if available)</td>
  </tr>
  <tr>
<td>coords.speed</td>
<td>The speed in meters per second (returned if available)</td>
  </tr>
  <tr>
<td>timestamp</td>
<td>The date/time of the response (returned if available)</td>
  </tr>
</tbody></table></div>
<!--stop-->
<hr>
<!--start-->
<h2>Geolocation Object - Other interesting Methods</h2>
<p>The Geolocation object also has other interesting methods:</p>
<ul>
  <li><code class="w3-codespan">watchPosition()</code> - Returns the current position of the user and continues to 
return updated position as the user moves (like the GPS in a car).</li>
  <li><code class="w3-codespan">clearWatch()</code> - Stops the <code class="w3-codespan">watchPosition()</code> method.</li>
</ul>
<p>The example below shows the <code class="w3-codespan">watchPosition()</code> method. You need an accurate GPS device to test this (like 
smartphone): </p>
<div class="w3-example">
<h3>Example</h3>
<pre class="w3-code"><code class="language-html">&lt;script&gt;
const x = document.getElementById("demo");
function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.watchPosition(showPosition);
  } else {
    x.innerHTML = "Geolocation is not supported by this browser.";
  }
}
function showPosition(position) {
  x.innerHTML = "Latitude: " + position.coords.latitude +
  "&lt;br&gt;Longitude: " + position.coords.longitude;
}
&lt;/script&gt;</code></pre>

</div>
<!--stop-->
<br>
<div class="w3-clear nextprev">
<a class="w3-left w3-btn" href="js_api_fetch.html">❮ Previous</a>
<a class="w3-right w3-btn" href="js_api_history.html">Next ❯</a>
</div>


