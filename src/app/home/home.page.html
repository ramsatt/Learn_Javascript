
<ion-header class="ion-no-border">
  <ion-toolbar color="primary">
    <ion-title>
      <div class="app-logo">
        <span class="logo-icon">JS</span>
        <span class="logo-text">Mastery</span>
      </div>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding-bottom">
  
  <!-- Header Section -->
  <div class="header-section ion-padding">
     <div class="user-greeting">
        <p class="welcome-text">Welcome <span class="wave">ðŸ‘‹</span></p>
        <h2>JS Learner</h2>
     </div>
     <div class="header-actions">
        <!-- Theme Toggle -->
        <ion-button fill="clear" class="action-btn" (click)="themeService.toggleTheme()">
            <ion-icon [name]="themeService.isDarkMode() ? 'sunny-outline' : 'moon-outline'" slot="icon-only"></ion-icon>
        </ion-button>
        
        <ion-button fill="clear" class="action-btn notification-btn">
            <ion-icon name="notifications-outline" slot="icon-only"></ion-icon>
            <div class="badge-dot"></div>
        </ion-button>
     </div>
  </div>

  <!-- Continue Learning Banner -->
  <div class="ion-padding-horizontal">
      <div class="continue-learning-card" (click)="continueToLast()">
          <div class="cl-header">
              <h3>Continue Learning</h3>
          </div>
          <div class="cl-content">
              <div class="course-info">
                  <h4>{{ lastModuleTitle }}</h4> 
                  <div class="progress-row">
                      <div class="progress-bar-bg">
                          <div class="progress-fill" [style.width.%]="lastModuleProgress"></div>
                      </div>
                      <span class="progress-text">{{ overallProgressText }}</span>
                  </div>
              </div>
              <div class="cl-action">
                  <div class="go-btn">
                      <ion-icon name="arrow-forward"></ion-icon>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <!-- Feature Class Categories -->
  <div class="section-container">
      <div class="section-header ion-padding-horizontal">
         <!-- Icon Grid Row -->
         <div class="category-row">
             <div class="cat-item">
                 <div class="cat-icon-box">
                     <ion-icon name="game-controller"></ion-icon>
                 </div>
                 <span>Game</span>
             </div>
             <div class="cat-item active">
                 <div class="cat-icon-box active">
                     <ion-icon name="brush"></ion-icon>
                 </div>
                 <span>Design</span>
             </div>
             <div class="cat-item">
                 <div class="cat-icon-box">
                     <ion-icon name="code-slash"></ion-icon>
                 </div>
                 <span>Developer</span>
             </div>
             <div class="cat-item">
                 <div class="cat-icon-box">
                     <ion-icon name="videocam"></ion-icon>
                 </div>
                 <span>Video</span>
             </div>
         </div>
      </div>

      <div class="section-header ion-padding-horizontal box-header">
          <h3>Modules</h3>
          <!-- <span class="see-all">See All</span> -->
      </div>
      
      <!-- Horizontal Scroll Cards -->
      <div class="horizontal-scroll-container">
          <!-- Real Data Loop -->
          <div class="feature-card" *ngFor="let section of menuData; let i = index" (click)="toggleSection(section)">
              <div class="card-img-wrapper">
                  <!-- Dynamic Gradient Background -->
                  <div class="img-placeholder" [style.background]="getModuleThumb(section, i)">
                     <!-- Varying Icons -->
                     <ion-icon name="logo-javascript" *ngIf="i % 3 === 0" size="large" style="font-size: 2.5rem; color:white; opacity:0.9; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));"></ion-icon>
                     <ion-icon name="code-slash" *ngIf="i % 3 === 1" size="large" style="font-size: 2.5rem; color:white; opacity:0.9; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));"></ion-icon>
                     <ion-icon name="layers" *ngIf="i % 3 === 2" size="large" style="font-size: 2.5rem; color:white; opacity:0.9; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));"></ion-icon>
                  </div>
              </div>
              <div class="card-details">
                  <h4>{{ section.title }}</h4>
                  <div class="price-row">
                      <span class="details-text">{{ section.items ? section.items.length : 0 }} Lessons</span>
                      <span class="course-count" *ngIf="section.progress && section.progress > 0" style="color: var(--ion-color-success)">{{ section.progress }}%</span>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <!-- Popular / Next Up logic -->
  <div class="section-container" style="margin-top: 10px;" *ngIf="menuData.length > 0">
      <div class="section-header ion-padding-horizontal box-header">
          <h3>All Topics</h3>
          <span class="see-all">Scroll Down</span>
      </div>

      <div class="popular-list ion-padding-horizontal">
          <div class="popular-card" *ngFor="let section of menuData" (click)="toggleSection(section)" style="margin-bottom: 12px;">
              <div class="pop-img" [style.background]="getCircleDash(section.progress || 0) === '0' ? '#e0e0e0' : 'rgba(76, 77, 220, 0.1)'">
                 <div class="tiny-placeholder" style="width:100%; height:100%; display:flex; align-items:center; justify-content:center;">
                     <ion-icon name="book" style="color: #666;"></ion-icon>
                 </div>
              </div>
              <div class="pop-details">
                  <h4>{{ section.title }}</h4>
                  <p>{{ section.items ? section.items.length : 0 }} Lessons â€¢ {{ section.progress || 0 }}% Complete</p>
              </div>
              <div class="pop-arrow">
                  <ion-icon name="arrow-forward"></ion-icon>
              </div>
          </div>
      </div>
  </div>

  <div style="height: 80px;"></div> <!-- Bottom Spacer for Tabs -->

</ion-content>

<!-- Custom Bottom Tab Bar ( Simulated since we don't have tabs router setup yet) -->
<div class="custom-tab-bar">
    <div class="tab-item active">
        <ion-icon name="home"></ion-icon>
        <span>Home</span>
    </div>
    <div class="tab-item">
        <ion-icon name="document-text-outline"></ion-icon>
    </div>
    <div class="tab-item">
        <ion-icon name="cart-outline"></ion-icon>
    </div>
    <div class="tab-item">
        <ion-icon name="person-outline"></ion-icon>
    </div>
</div>
